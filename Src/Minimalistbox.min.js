/** Minimalistbox * Created by : Ilker Guller */
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):b(jQuery)})(function(b){function e(a,c){this.element=a;this.$el=b(this.element);this.settings=b.extend({},f,c);this._defaults=f;this._name="Minimalistbox";this.init()}var f={placeholder:"",clear:!1,onClear:null,onItemSelected:null,placeholderclass:"placeholder"};e.prototype={init:function(){this.createHtml()},isInternetExplorer:function(){var a=-1;"Microsoft Internet Explorer"==navigator.appName&&null!==(new RegExp(/MSIE ([0-9]{1,}[\.0-9]{0,})/)).exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a},createHtml:function(){var a=b("<div></div>"),c=b("<div><ul></ul></div>"),d=b("<div><span></span></div>"),e=this;this.$el.attr("class")&&a.addClass(this.$el.attr("class"));this.$el.addClass(this._name+"-hiddenselect");a.addClass(this._name+"-main");this.$el.attr("name")&&a.addClass(this._name+"-"+this.$el.attr("name"));this.$el.attr("id")&&a.addClass(this._name+"-"+this.$el.attr("id"));c.addClass(this._name+"-items");var f=c.find("ul");this.$el.find("option").each(function(){var a=b("<li></li>");a.addClass(e._name+"-item");a.text(b(this).text());a.data("value",b(this).val());f.append(a)});d.addClass(this._name+"-result");this.settings.clear&&d.append('<i class="'+this._name+'-actionClear">X</i>');a.append(d);a.append(c);this.$el.after(a);this.$el.appendTo(a);this.$parent=a;this.changeSelectedItem();this.addEvents()},addEvents:function(){var a=this;this.$parent.on("click","."+a._name+"-item",function(){a.onItemSelected(b(this))});this.$parent.on("click","."+a._name+"-result",function(){a.$parent.toggleClass(a._name+"-active")});if(this.settings.clear)this.$parent.on("click","."+a._name+"-actionClear",function(c){c.preventDefault();c.stopPropagation();a.onClear();""!==a.settings.placeholder?a.addPlaceHolder():a.changeSelectedItem(a.$el.find("option:eq(0)").text())})},addPlaceHolder:function(){this.$parent.find("."+this._name+"-result").addClass(this.settings.placeholderclass).find("span").text(this.settings.placeholder)},onClear:function(){var a=this.$parent.find("."+this._name+"-items"),c=this.$el;c.find("option:selected").prop("selected",!1);a.find("."+this._name+"-selected").removeClass(this._name+"-selected");c.trigger("clear");if(null!==this.settings.onItemSelected&&"function"===typeof this.settings.onClear)this.settings.onClear()},onItemSelected:function(a){var c=this.$parent.find("."+this._name+"-items"),b=this.$el;c.find("."+this._name+"-selected").removeClass(this._name+"-selected");a.addClass(this._name+"-selected");b.find("option[value='"+a.data("value")+"']").prop("selected",!0);b.trigger("change");this.changeSelectedItem(a.text());this.$parent.toggleClass(this._name+"-active");if(null!==this.settings.onItemSelected&&"function"===typeof this.settings.onItemSelected)this.settings.onItemSelected(a)},changeSelectedItem:function(a){var b=this.$el,d=this.$parent.find("."+this._name+"-result");d.hasClass(this.settings.placeholderclass)&&d.removeClass(this.settings.placeholderclass);a?d.find("span").text(a):0<b.find("option:selected").length&&b.find("option:selected").attr("selected")?d.find("span").text(b.find("option:selected").text()):""!==this.settings.placeholder?this.addPlaceHolder():d.find("span").text(b.find("option:eq(0)").text())}};b.fn.Minimalistbox=function(a){return this.each(function(){b.data(this,"plugin_Minimalistbox")||b.data(this,"plugin_Minimalistbox",new e(this,a))})}});